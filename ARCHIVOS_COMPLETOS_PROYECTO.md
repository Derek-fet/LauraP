# üìÑ ARCHIVOS COMPLETOS DEL PROYECTO RESTAURANTE

Este documento contiene el contenido completo de todos los archivos importantes del proyecto para pasar como contexto a una IA.

---

## üî¥ BACKEND - DJANGO

*/@proyecto_restaurante/restaurante/admin.py */
```python
from django.contrib import admin
from .models import Plato, Mesa, Pedido

admin.site.register(Plato)
admin.site.register(Mesa)
admin.site.register(Pedido)
```
///////////////

*/@proyecto_restaurante/restaurante_project/settings.py */
```python
"""
Django settings for restaurante_project project.

Generated by 'django-admin startproject' using Django 5.2.6.
"""

from pathlib import Path
import os

# ---------------------------------------------
# BASE DIR
# ---------------------------------------------
BASE_DIR = Path(__file__).resolve().parent.parent


# ---------------------------------------------
# SECURITY
# ---------------------------------------------
SECRET_KEY = 'django-insecure-a2=1ean2v_kv0z8f%aqa%86yk)=*bqhvvwh6kqv6_0rbg3)d^9'

DEBUG = True

ALLOWED_HOSTS = ["*"]  # ‚ö†Ô∏è Permite todo en desarrollo. Si quieres puedes cambiarlo luego.


# ---------------------------------------------
# INSTALLED APPS
# ---------------------------------------------
INSTALLED_APPS = [
    # Django
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',

    # Terceros
    'rest_framework',
    'corsheaders',

    # Apps propias
    'restaurante',
]


# ---------------------------------------------
# MIDDLEWARE
# ---------------------------------------------
MIDDLEWARE = [
    'corsheaders.middleware.CorsMiddleware',  # üëà Debe ir PRIMERO
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]


# ---------------------------------------------
# URLS
# ---------------------------------------------
ROOT_URLCONF = 'restaurante_project.urls'


# ---------------------------------------------
# TEMPLATES
# ---------------------------------------------
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],  # puedes agregar templates aqu√≠ si los usas
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]


# ---------------------------------------------
# WSGI
# ---------------------------------------------
WSGI_APPLICATION = 'restaurante_project.wsgi.application'


# ---------------------------------------------
# DATABASE (POSTGRESQL)
# ---------------------------------------------
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'restaurante_db',
        'USER': 'postgres',
        'PASSWORD': 'laura12345',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}


# ---------------------------------------------
# VALIDACI√ìN PASSWORD
# ---------------------------------------------
AUTH_PASSWORD_VALIDATORS = [
    {'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator'},
    {'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator'},
    {'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator'},
    {'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator'},
]


# ---------------------------------------------
# INTERNACIONALIZACI√ìN
# ---------------------------------------------
LANGUAGE_CODE = 'es-co'
TIME_ZONE = 'America/Bogota'

USE_I18N = True
USE_TZ = True


# ---------------------------------------------
# STATIC FILES
# ---------------------------------------------
STATIC_URL = '/static/'
STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')  # √∫til en deploy

STATICFILES_DIRS = [
    os.path.join(BASE_DIR, 'static'),
]


# ---------------------------------------------
# DEFAULT PRIMARY KEY
# ---------------------------------------------
DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'


# ---------------------------------------------
# CORS CONFIG ‚Üí PERMITE ANGULAR
# ---------------------------------------------
CORS_ALLOWED_ORIGINS = [
    "http://localhost:4200",
    "http://127.0.0.1:4200",
]

# Permite TODO en desarrollo
CORS_ALLOW_ALL_ORIGINS = True

# Permite env√≠o de cookies desde Angular si alg√∫n d√≠a lo usas
CORS_ALLOW_CREDENTIALS = True
```
///////////////

*/@proyecto_restaurante/restaurante/models.py */
```python
from django.db import models

class Plato(models.Model):
    nombre = models.CharField(max_length=100)
    descripcion = models.TextField()
    precio = models.DecimalField(max_digits=8, decimal_places=2)

    def __str__(self):
        return self.nombre


class Mesa(models.Model):
    numero = models.IntegerField()
    capacidad = models.IntegerField()
    disponible = models.BooleanField(default=True)

    def __str__(self):
        return f"Mesa {self.numero}"


class Pedido(models.Model):
    mesa = models.ForeignKey(Mesa, on_delete=models.CASCADE)
    platos = models.ManyToManyField(Plato)
    fecha = models.DateTimeField(auto_now_add=True)
    entregado = models.BooleanField(default=False)

    def __str__(self):
        return f"Pedido #{self.id} - Mesa {self.mesa.numero}"


class Reserva(models.Model):
    nombre_cliente = models.CharField(max_length=100)
    mesa = models.ForeignKey(Mesa, on_delete=models.CASCADE)
    fecha = models.DateField()
    hora = models.TimeField()
    cantidad_personas = models.IntegerField()

    def __str__(self):
        return f"Reserva de {self.nombre_cliente} - {self.fecha} {self.hora}"


class Usuario(models.Model):
    nombre = models.CharField(max_length=100)
    email = models.EmailField(unique=True)
    telefono = models.CharField(max_length=15, blank=True, null=True)

    def __str__(self):
        return self.nombre
```
///////////////

*/@proyecto_restaurante/restaurante/views.py */
```python
from rest_framework import viewsets, status
from rest_framework.response import Response
from rest_framework.decorators import action
from django.utils import timezone

from .models import Mesa, Plato, Pedido, Reserva, Usuario
from .serializers import (
    MesaSerializer, PlatoSerializer, PedidoSerializer,
    ReservaSerializer, UsuarioSerializer
)

class MesaViewSet(viewsets.ModelViewSet):
    queryset = Mesa.objects.all()
    serializer_class = MesaSerializer

    @action(detail=False, methods=["get"])
    def disponibles(self, request):
        disponibles = Mesa.objects.filter(estado="Disponible")
        serializer = self.get_serializer(disponibles, many=True)
        return Response(serializer.data)

class PlatoViewSet(viewsets.ModelViewSet):
    queryset = Plato.objects.all()
    serializer_class = PlatoSerializer


class PedidoViewSet(viewsets.ModelViewSet):
    queryset = Pedido.objects.all()
    serializer_class = PedidoSerializer


class ReservaViewSet(viewsets.ModelViewSet):
    queryset = Reserva.objects.all()
    serializer_class = ReservaSerializer

    # üßπ Limpia reservas vencidas (opcional pero recomendado)
    def list(self, request, *args, **kwargs):
        now = timezone.now()

        vencidas = Reserva.objects.filter(
            estado="activa",
            fecha__lt=now.date()
        )
        for r in vencidas:
            r.estado = "vencida"
            r.save()

        return super().list(request, *args, **kwargs)

    # ‚úî Validaci√≥n ya est√° en el serializer
    def create(self, request, *args, **kwargs):
        serializer = self.get_serializer(data=request.data)

        if not serializer.is_valid():
            return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

        self.perform_create(serializer)
        return Response(serializer.data, status=status.HTTP_201_CREATED)

    # üî• NUEVO: Cancelar reserva
    @action(detail=True, methods=['post'])
    def cancelar(self, request, pk=None):
        reserva = self.get_object()
        
        if reserva.estado != "activa":
            return Response({"error": "Esta reserva no est√° activa."},
                            status=status.HTTP_400_BAD_REQUEST)

        reserva.estado = "cancelada"
        reserva.save()

        return Response(
            {"mensaje": "Reserva cancelada correctamente."},
            status=status.HTTP_200_OK
        )


class UsuarioViewSet(viewsets.ModelViewSet):
    queryset = Usuario.objects.all()
    serializer_class = UsuarioSerializer
```
///////////////

*/@proyecto_restaurante/restaurante/serializers.py */
```python
from rest_framework import serializers
from .models import Mesa, Plato, Pedido, Reserva, Usuario

class MesaSerializer(serializers.ModelSerializer):
    class Meta:
        model = Mesa
        fields = '__all__'

class PlatoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Plato
        fields = '__all__'

class PedidoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Pedido
        fields = '__all__'

class ReservaSerializer(serializers.ModelSerializer):
    class Meta:
        model = Reserva
        fields = '__all__'

class UsuarioSerializer(serializers.ModelSerializer):
    class Meta:
        model = Usuario
        fields = '__all__'
```
///////////////

*/@proyecto_restaurante/restaurante/urls.py */
```python
from django.urls import path, include
from rest_framework.routers import DefaultRouter
from .views import MesaViewSet, PlatoViewSet, PedidoViewSet, ReservaViewSet, UsuarioViewSet

router = DefaultRouter()
router.register('mesas', MesaViewSet)
router.register('platos', PlatoViewSet)
router.register('pedidos', PedidoViewSet)
router.register('reservas', ReservaViewSet)
router.register('usuarios', UsuarioViewSet)

urlpatterns = [
    path('', include(router.urls)),
]
```
///////////////

*/@proyecto_restaurante/restaurante_project/urls.py */
```python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('api/', include('restaurante.urls')),  # SOLO AQU√ç SE PONE /api/
]
```
///////////////

*/@proyecto_restaurante/manage.py */
```python
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'restaurante_project.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()
```
///////////////

---

## üü¢ FRONTEND - ANGULAR

*/@restaurante-frontend/src/main.ts */
```typescript
// src/main.ts

import 'zone.js';
import { bootstrapApplication } from '@angular/platform-browser';
import { AppComponent } from './app/app.component';
import { appConfig } from './app/app.config'; // üëà Importante

bootstrapApplication(AppComponent, appConfig)
  .catch(err => console.error(err));
```
///////////////

*/@restaurante-frontend/src/app/app.config.ts */
```typescript
// src/app/app.config.ts

import { ApplicationConfig } from '@angular/core';
import { provideRouter } from '@angular/router';
import { provideHttpClient } from '@angular/common/http'; 
import { routes } from './app.routes';

export const appConfig: ApplicationConfig = {
  providers: [
    provideRouter(routes),
    provideHttpClient() 
  ]
};
```
///////////////

*/@restaurante-frontend/src/app/app.routes.ts */
```typescript
// src/app/app.routes.ts

import { Routes } from '@angular/router';

// Importar componentes desde /components
import { HomeComponent } from './components/home/home.component';
import { PlatosComponent } from './components/platos/platos.component';
import { ReservasComponent } from './components/reservas/reservas.component';
import { PedidosComponent } from './components/pedidos/pedidos.component';
import { MesasComponent } from './components/mesas/mesas.component';
import { UsuariosComponent } from './components/usuarios/usuarios.component';

export const routes: Routes = [

  // Ruta por defecto
  { path: '', redirectTo: 'home', pathMatch: 'full' },

  // P√°ginas
  { path: 'home', component: HomeComponent },
  { path: 'platos', component: PlatosComponent },
  { path: 'reservas', component: ReservasComponent },
  { path: 'pedidos', component: PedidosComponent },
  { path: 'mesas', component: MesasComponent },
  { path: 'usuarios', component: UsuariosComponent },

  // Ruta no encontrada
  { path: '**', redirectTo: 'home' }
];
```
///////////////

*/@restaurante-frontend/src/app/app.component.ts */
```typescript
import { Component } from '@angular/core';
import { RouterOutlet } from '@angular/router';
import { HeaderComponent } from './components/header/header.component';
import { FooterComponent } from './components/footer/footer.component';

@Component({
  selector: 'app-root',
  standalone: true,
  imports: [RouterOutlet, HeaderComponent, FooterComponent],
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {}
```
///////////////

*/@restaurante-frontend/src/environments/environment.ts */
```typescript
export const environment = {
  production: false,
  apiUrl: 'http://127.0.0.1:8000/api/'
};
```
///////////////

*/@restaurante-frontend/src/app/models/plato.model.ts */
```typescript
export interface Plato {
  id: number;
  nombre: string;
  descripcion: string;
  precio: number;
}
```
///////////////

*/@restaurante-frontend/src/app/services/platos.service.ts */
```typescript
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';
import { Plato } from '../models/plato.model';

@Injectable({
  providedIn: 'root'
})
export class PlatosService {

  private apiUrl = 'http://127.0.0.1:8000/api/platos/';

  constructor(private http: HttpClient) {}

  getPlatos(): Observable<Plato[]> {
    return this.http.get<Plato[]>(this.apiUrl);
  }
}
```
///////////////

*/@restaurante-frontend/src/app/services/reservas.service.ts */
```typescript
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class ReservasService {

  private apiUrl = 'http://127.0.0.1:8000/api/reservas/';
  private apiMesas = 'http://127.0.0.1:8000/api/mesas/';

  constructor(private http: HttpClient) {}

  getReservas(): Observable<any[]> {
    return this.http.get<any[]>(this.apiUrl);
  }

  crearReserva(data: any): Observable<any> {
    return this.http.post<any>(this.apiUrl, data);
  }

  getMesasDisponibles(): Observable<any[]> {
    return this.http.get<any[]>(this.apiMesas);
  }
}
```
///////////////

*/@restaurante-frontend/src/app/services/mesas.service.ts */
```typescript
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class MesasService {
  private apiURL = 'http://127.0.0.1:8000/api/mesas/';
  private reservasURL = 'http://127.0.0.1:8000/api/reservas/';

  constructor(private http: HttpClient) {}

  // Mesas
  obtenerMesas(): Observable<any[]> {
    return this.http.get<any[]>(this.apiURL);
  }

  crearMesa(data: any): Observable<any> {
    return this.http.post<any>(this.apiURL, data);
  }

  actualizarMesa(id: number, data: any): Observable<any> {
    return this.http.put<any>(`${this.apiURL}${id}/`, data);
  }

  eliminarMesa(id: number): Observable<any> {
    return this.http.delete<any>(`${this.apiURL}${id}/`);
  }

  // Reservas relacionadas (filtrar por mesa)
  // Asume que tu endpoint de reservas acepta ?mesa=<id>
  obtenerReservasPorMesa(mesaId: number): Observable<any[]> {
    return this.http.get<any[]>(`${this.reservasURL}?mesa=${mesaId}`);
  }
  
}
```
///////////////

*/@restaurante-frontend/src/app/services/pedidos.service.ts */
```typescript
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class PedidosService {

  private apiUrl = 'http://127.0.0.1:8000/api/pedidos/';

  constructor(private http: HttpClient) {}

  getPedidos(): Observable<any> {
    return this.http.get(this.apiUrl);
  }
}
```
///////////////

*/@restaurante-frontend/src/app/services/usuarios.service.ts */
```typescript
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class UsuariosService {

  private apiUrl = 'http://127.0.0.1:8000/api/usuarios/';

  constructor(private http: HttpClient) {}

  getUsuarios(): Observable<any> {
    return this.http.get(this.apiUrl);
  }
}
```
///////////////

*/@restaurante-frontend/src/app/components/platos/platos.component.ts */
```typescript
import { Component, OnInit } from '@angular/core';
import { CommonModule } from '@angular/common';
import { PlatosService } from '../../services/platos.service';
import { Plato } from '../../models/plato.model';

@Component({
  selector: 'app-platos',
  standalone: true,
  imports: [CommonModule],
  templateUrl: './platos.component.html',
  styleUrls: ['./platos.component.css']
})
export class PlatosComponent implements OnInit {

  platos: Plato[] = [];

  constructor(private platosService: PlatosService) {}

  ngOnInit(): void {
    this.cargarPlatos();
  }

  cargarPlatos(): void {
    this.platosService.getPlatos().subscribe({
      next: (data) => {
        this.platos = data;
        console.log('Platos cargados:', data);
      },
      error: (error) => {
        console.error('Error al cargar platos', error);
      }
    });
  }
}
```
///////////////

---

## üìã RESUMEN

Este documento contiene todos los archivos cr√≠ticos del proyecto:

**Backend (Django):**
- `admin.py` - Configuraci√≥n del admin de Django
- `settings.py` - Configuraci√≥n completa del proyecto
- `models.py` - Modelos de datos (Plato, Mesa, Pedido, Reserva, Usuario)
- `views.py` - ViewSets con l√≥gica de negocio
- `serializers.py` - Serializers para validaci√≥n
- `urls.py` (restaurante) - Router de la API
- `urls.py` (restaurante_project) - URLs ra√≠z
- `manage.py` - Punto de entrada de Django

**Frontend (Angular 18):**
- `main.ts` - Bootstrap de la aplicaci√≥n
- `app.config.ts` - Configuraci√≥n de la app
- `app.routes.ts` - Rutas de la aplicaci√≥n
- `app.component.ts` - Componente ra√≠z
- `environment.ts` - Configuraci√≥n de entorno
- `plato.model.ts` - Interface TypeScript
- `platos.service.ts` - Servicio HTTP para platos
- `reservas.service.ts` - Servicio HTTP para reservas
- `mesas.service.ts` - Servicio HTTP para mesas
- `pedidos.service.ts` - Servicio HTTP para pedidos
- `usuarios.service.ts` - Servicio HTTP para usuarios
- `platos.component.ts` - Componente de ejemplo

---

**√öltima actualizaci√≥n**: Generado autom√°ticamente con todos los archivos del proyecto

